{
    "projectType": "application",
    "targets": {
        "build": {
            "executor": "nx:run-commands",
            "options": {
                "command": "npm run build",
                "cwd": "apps/frontend"
            }
        },
        "serve": {
            "executor": "nx:run-commands",
            "options": {
                "command": "npm run dev",
                "cwd": "apps/frontend"
            }
        },
        "test": {
            "executor": "nx:run-commands",
            "options": {
                "command": "npm run test",
                "cwd": "apps/frontend"
            }
        },
        "test:watch": {
            "executor": "nx:run-commands",
            "options": {
                "command": "npm run test:watch",
                "cwd": "apps/frontend"
            }
        },
        "test:coverage": {
            "executor": "nx:run-commands",
            "options": {
                "command": "npm run test:coverage",
                "cwd": "apps/frontend"
            }
        },
        "publish": {
            "executor": "nx:run-commands",
            "options": {
                "command": "docker build --target production -t \"$DOCKER_USERNAME/${REPO_NAME}_frontend:$VERSION\" -t \"$DOCKER_USERNAME/${REPO_NAME}_frontend:latest\" . && docker push \"$DOCKER_USERNAME/${REPO_NAME}_frontend:$VERSION\" && docker push \"$DOCKER_USERNAME/${REPO_NAME}_frontend:latest\"",
                "cwd": "apps/frontend"
            }
        },
        "retag": {
            "executor": "nx:run-commands",
            "options": {
                "command": "docker buildx imagetools create --tag \"$DOCKER_USERNAME/${REPO_NAME}_frontend:$VERSION\" \"$DOCKER_USERNAME/${REPO_NAME}_frontend:latest\"",
                "cwd": "apps/frontend"
            }
        },
        "deploy": {
            "executor": "nx:run-commands",
            "options": {
                "command": "envsubst < k8s/deployment.yaml | kubectl apply -f -",
                "cwd": "apps/frontend"
            },
            "dependsOn": ["publish"]
        }
    }
}